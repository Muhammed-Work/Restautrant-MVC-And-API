@model RestaurantGorRahsa.Models.ModelMeal



<h2>Cearte Meal</h2>

<form asp-action="CreateEdite" method="post" enctype="multipart/form-data">
    @Html.AntiForgeryToken()

  
        <input type="hidden"tt asp-for="ID" class="form-control" />
    <div class="form-group">
        <label asp-for="Name" class="control-label">Meal Name</label>
        <input asp-for="Name" class="form-control" />
        <span asp-validation-for="Name" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="OfferedNumber" class="control-label">Offered Number</label>
        <input asp-for="OfferedNumber" class="form-control" />
        <span asp-validation-for="OfferedNumber" class="text-danger"></span>
    </div>

    <div class="form-group">
        <label asp-for="price" class="control-label">Price</label>
        <input asp-for="price" class="form-control" />
        <span asp-validation-for="price" class="text-danger"></span>
    </div>

    <div>
        <label asp-for="TypeID"></label>
        <select  asp-for="TypeID" class="form-control" asp-items="@(new SelectList(ViewBag.Types, "Id", "Name", Model.TypeID))" onchange="setType()">
            <option value="">-- Select Type --</option>
        </select>
        <span asp-validation-for="TypeID" class="text-danger"></span>
    </div>
    

    <div class="form-group">
        <label asp-for="ImageName" class="control-label">Upload Image</label>
        <input type="file" name="files" class="form-control" />
    </div>

    <div class="form-group">
        @if (!string.IsNullOrEmpty(Model.ImageName))
        {
            <p>Current Image:</p>
            <img src="~/Uploads/Images/@Model.ImageName" alt="Meal Image" style="max-height: 200px;" />
        }
    </div>

    <input type="hidden" asp-for="ID" />

    <div class="form-group">
        <button type="submit" class="btn btn-primary">Save</button>
        <a asp-action="Index" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<script>
    function setType() {
        // Get the selected TypeID from the dropdown
        var typeId = document.getElementById('TypeID').value;

        // Get the list of types from ViewBag
        var types = @Html.Raw(Json.Serialize(ViewBag.Types));

        // Find the selected type based on TypeID
        var selectedType = types.find(t => t.Id == typeId);

        if (selectedType) {
            // Optionally, you can log or use the full Type information
            console.log("Selected Type: " + selectedType.Name);

            // Set the hidden input with the full Type object
            document.getElementById('Type').value = JSON.stringify(selectedType);
        } else {
            // If no type is selected, clear the hidden input
            document.getElementById('Type').value = "";
        }
    }
</script>

@section Scripts {
    @await Html.PartialAsync("_ValidationScriptsPartial")
}
